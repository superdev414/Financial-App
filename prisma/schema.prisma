// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Account{
  id String @id @default(uuid())
  accountBalance Float
  accountValue Float

  portfolio Portfolio?
  watchlist Watchlist?
}

model Portfolio {
  id String @id @default(uuid())
  portfolioVal Float 

  companies Company[]

  account Account @relation(fields: [accountId], references: [id],onDelete:  Cascade)
  accountId String @unique
}

model Watchlist {
  id String @id @default(uuid())
  name String

  companies Watchlist_Company[]

  account Account @relation(fields: [accountId], references: [id])
  accountId String @unique
 
}

model Watchlist_Company {
  watchlist Watchlist @relation(fields: [watchlistId],references: [id])
  watchlistId String
  company  Company @relation(fields: [companyId], references:[id])
  companyId String
  symbol String
  @@id([watchlistId,companyId])
}

model Company {
  id String @id @default(uuid())
  symbol String @unique
  price Float 
  yahooMarketV2Data Json
  yahooStockV2Summary Json
  resources Resource?

  logo Logo?
  portfolio Portfolio? @relation(fields: [portfolioId], references: [id])
  portfolioId String?

  watchlists Watchlist_Company[]
}
model Transaction {
  id String @id @default(uuid())

}

model Ticker {
  id String @id @default(uuid())
  symbol String @unique
}



model Category{
  int String @id @default(uuid())
  name String 
}


model AllTicker {
  id String @id @default(uuid())
  symbol String @unique
}

// // cannot create a ticker without a company
// model Ticker {
//   id String @id @default(uuid())
//   price String
//   imgSrc String  
//   symbol String @unique
// }

model Logo {
  id String @id @default(uuid())
  symbol String @unique
  logo String @unique

  company Company @relation(fields: [symbol], references: [symbol])
}
model Resource {
  symbol String @unique
  logoImg String
  productImg String 

  company Company @relation(fields: [symbol], references: [symbol])

}

model Product {
  id String @id @default(uuid())
  symbol String @unique
  name String
  imgSrc String
}

model ChatBot {
  id String @id @default(uuid())
  messages Message[]
}

enum Role {
  system
  user
}
model Message {
  id String @id @default(uuid())
  role Role
  content String @db.Text
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  chatBot  ChatBot @relation(fields: [id], references: [id])
}



